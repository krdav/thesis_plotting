# tRNA databse
!!! This folder was lifted from the krdav tRNA-seq repo, the following is also part of that !!!


This folder contains the tRNA transcript sequences that are used for alignment of the reads generated by tRNA sequencing.
The sequences have been formatted to work with subsequent processing so if new sequences, e.g. a new species, needs to be added they must be formatted correctly.


### Getting tRNA sequences
Mature (no introns) cytosolic tRNA transcripts can be downloaded from the gtRNAdb database.
This database is great because it sorts out a complex mix of pseudogenes and non-transcribed tRNAs as well as providing mature tRNA sequences.

For human:  
`wget http://gtrnadb.ucsc.edu/genomes/eukaryota/Hsapi38/hg38-mature-tRNAs.fa`

For mouse:  
`wget http://gtrnadb.ucsc.edu/genomes/eukaryota/Mmusc10/mm10-mature-tRNAs.fa`


Mitochondrial tRNAs are not so complex as the nuclear encoded ones.
One can basically look them up on the mitochondrial genome and copy them.
The [mim-tRNAseq repo](https://github.com/nedialkova-lab/mim-tRNAseq) (Behrens et al. 2021) has compiled them and can be downloaded from my fork.

For human:  
`wget https://raw.githubusercontent.com/krdav/mim-tRNAseq/master/mimseq/data/hg19-eColitK/hg19-mitotRNAs.fa`

For mouse:  
`wget https://raw.githubusercontent.com/krdav/mim-tRNAseq/master/mimseq/data/mm10-eColitK/mm10-mitotRNAs.fa`



### Merging and formatting
Cyto/mito tRNA sequences are merged and formatted, and an Ecoli Lys tRNA sequence is added becuase this sequence is used as a spike-in control.
Note that the Ecoli Lys tRNA sequence is hard-coded in the `tRNAdb_tool.py` script...


Merge and format human:  
`./tRNAdb_tool.py hg19-mitotRNAs.fa hg38-mature-tRNAs.fa > human/hg38-tRNAs.fa`

Merge and format mouse:  
`./tRNAdb_tool.py mm10-mitotRNAs.fa mm10-mature-tRNAs.fa > mouse/mm10-tRNAs.fa`


### Make BLAST database for SWIPE
There are two ways of aligning tRNA sequencing reads to a reference: a) fast heuristics based alignment, or b) slow deterministic alignment.
This repo uses the latter (i.e. the Smith-Waterman algorithm), but the time spent on alignment is substantially decreased by usign a good implementation.
By informal tests, the fastest implementation is [SWIPE](https://github.com/torognes/swipe).
SWIPE requires a pre-made BLAST database of the reference, which needs to be made using `makeblastdb` with the `-blastdb_version 4` flag.

To make this database, step into the folder with the tRNA fasta file and execute the following command:  
`makeblastdb -dbtype prot -in <your_tRNA_transcripts.fa> -blastdb_version 4`

You may note the `-dbtype prot` flag, and wonder why you should specify the sequence as protein when it is DNA.
This is due to a quirk in SWIPE, which will only allow us to specify a substitution matrix for protein, not for DNA.
This behavior of SWIPE makes sense in most applications, except when you want to "mask" positions in the reference sequences.
However, specifying the sequence as protein and providing a custom substitution matrix will work fine.
Masking of the reference can then be done by replacing the masked nt. with "N" and using an appropiate substitution matrix.





